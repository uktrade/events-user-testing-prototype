
<!--  MACRO TO MAKE EACH LIVE LINE ITEM -->
{% macro trackingLinks(number) %}
<tr>
  {% if number == 1 %}
    <td style="font-weight:700; width:30%; padding-top:25px; padding-bottom:20px;";>Uncategorised (default link)</td>
  {% else %}
    <td style="font-weight:700; width:30%; padding-top:25px; padding-bottom:20px;";>{{ session.eventsLiveURLS[session.currentEventShowing][0][number] }}</td>
  {% endif %}

  <td style="padding-top:25px; padding-bottom:20px; width:70%;">
    <div style="display:flex;  justify-content: space-between;">
      <p style="margin-top:8px; margin-bottom:0px; margin-right:30px;">www.events.great.gov.uk/{{ session.eventsLiveURLS[session.currentEventShowing][1][number] }}</p>
      <div>
        <input style="float:right;" type="submit" class="button-secondary" formaction="/create-event/go-live" value="Copy to clipboard">
      </div>
    </div>

  </td>
</tr>
{% endmacro %}



<table style="width:100%;">


  {% if 1 < session.eventsLiveURLS[session.currentEventShowing][0].length  %}
    {{ trackingLinks(1) }}
  {% endif %}


  {% if 2 < session.eventsLiveURLS[session.currentEventShowing][0].length %}
    {{ trackingLinks(2) }}
  {% endif %}


  {% if 3 < session.eventsLiveURLS[session.currentEventShowing][0].length %}
    {{ trackingLinks(3) }}
  {% endif %}


  {% if 4 < session.eventsLiveURLS[session.currentEventShowing][0].length %}
    {{ trackingLinks(4) }}
  {% endif %}


  {% if 5 < session.eventsLiveURLS[session.currentEventShowing][0].length  %}
    {{ trackingLinks(5) }}
  {% endif %}


  {% if 6 < session.eventsLiveURLS[session.currentEventShowing][0].length  %}
    {{ trackingLinks(6) }}
  {% endif %}



  <!-- Add new  tracking link -->
  <tr>
    <td style="font-weight:700; width:30%; padding-top:20px; padding-bottom:40px;";>

      <label class="form-label" >
        Marketing channel name
        {% if errorTrackingName %}
        <p class="error-message">
          Enter tracking name
        </p>
        {% endif %}
      </label>

      <input type="text" class="form-control  {% if errorTrackingName %} form-control-error {% endif %}"
             id="new-link-name" name="new-link-name" value="" style="width:90%;">
    </td>

    <td style="width:70%; margin-top:0px; padding-top:22px; padding-bottom:5px; ">
      {% if errorTrackingName %}
        <div style="width:100%;">
      {% else %}
        <div style="width:100%;">
      {% endif %}

          <div id="new-url-area" name="new-url-area" style="display:none; padding-top:18px;">

            <div style="display:flex; justify-content: space-between;">

              <div style="display:flex">
                <p style="margin-top:6px;">www.events.great.gov.uk/</p>
                <textarea type="text" class="form-control"  id="new-url" name="new-url"  rows="2"
                          style="width:320px; margin-top:0px; margin-bottom:0px;">{{session.eventsLiveURLS[session.currentEventShowing][1][1]}}</textarea>
              </div>

              <div id=divsave" style="margin-left:0px;">
                <input style="width:100%;" type="submit" class="button" formaction="/monitor/add-tracking-link" value="Save">
              </div>

            </div>

          </div>

          <div style="padding-top:20px; padding-bottom:12px;" id="link-generator">
            <p class="button-secondary" onclick="makeLink()"  style="margin-top:0px">Generate link</p>
          </div>

      {% if errorTrackingName %}
        </div>
      {% else %}
        </div>
      {% endif %}

    </td>

  </tr>

</table>


<script>

  function makeLink()
  {
    var urlOfName = document.getElementById('new-link-name').value;

    // Make lower case
    urlOfName = urlOfName.toLowerCase();

    // remove space an then hyphens
    urlOfName = urlOfName.replace(" - ", " ");

    // remove spaces
    urlOfName = urlOfName.replace(/\s/g, '-');

    // remove ampersand
    urlOfName = urlOfName.replace(/&/g, "");

    // aDD TO THE LINK BOX
    // aDD TO THE LINK BOX
    document.getElementById('new-url').value = (document.getElementById('new-url').value + "-" + urlOfName);

    //document.getElementById('divsave').style.display = 'block';

    document.getElementById('link-generator').style.display = 'none';
    document.getElementById('new-url-area').style.display = 'block';
  }





</script>




